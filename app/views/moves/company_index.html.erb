<div class="container-fluid text-align-center justify-content-center mb-5">
  <div class="centered-container mb-5">
    <h1>Choose a move and place a bid!</h1>
  </div>
  <%= form_with url: company_path, method: :get  do %>
    <div class="d-flex justify-content-between form-container">
      <div style="width:70%; position: relative">
        <%= text_field_tag :query,
          params[:query],
          class: "form-control",
          placeholder: "Find the perfect move"%>
        <button name="button" type="submit" class="btn btn-flat" style="position: absolute; top: 2px;right: 2px;" >
          <i class="fas fa-search"></i>
        </button>
      </div>
      <div class="filter-form simple_form position: relative">
        <select class="search-form-control form-control form-control" type="text" name="filter" id="search_query_filter">
          <option value="created">Recently posted</option>
          <option value="earliest">Earliest move</option>
        </select>
        <button name="button" type="submit" class="btn btn-flat" style="position: absolute top: 2px;right: 2px;" >
          <i class="fa-solid fa-filter"></i>        </button>
      </div>
    </div>
  <% end %>

<div class="container m-5">
  <div class="low-container">
    <div class="left-container">
      <div class="move-grid" id="move-grid">
        <% @moves.each do |move| %>
          <div class="small-card mb-5" id="card-div">
            <%= link_to move_path(move.id), data:{}, style:"text-decoration:none;", title: "show this move" do %>
              <div>
                <% if move.status == "open" %>
                  <h6 style="margin-left: 200px"> <i class="fa-solid fa-arrow-rotate-right"></i> <%= move.status %></h6>
                <% elsif move.status == "pending" %>
                  <h6 style="margin-left: 200px"> <i class="fa-solid fa-arrows-rotate fa-spin"> </i> <%= move.status %> </h6>
                <% elsif move.status == "confirmed" %>
                  <h6 style="margin-left: 200px"> <i class="fa-solid fa-square-check" style="color: #73c431;"> </i> <%= move.status %></h6>
                <% end %>
              </div>
              <h5 class="card-title"> <i class="fa-solid fa-calendar" style="color: #f66b0e"></i>
                <%= move.date.strftime("%d %b %Y") %></h5>
              <br>
              <h5 class="card-title"><i class="fa-regular fa-clock" style="color: #f66b0e"></i>
                <%= move.date.strftime("%l:%m %p") %></h5>
                <h5 class="card-title"> <i class="fa-solid fa-map-pin"></i> <%= move.created_at %></h5>

              <br><h6>from</h6>
              <h5 class="card-title"> <i class="fa-solid fa-location-dot" style="color: #f66b0e"></i>
                <%= move.start_point %></h5>
              <br><h6 class="ml-1" >to</h6>
              <h5 class="card-title"> <i class="fa-solid fa-map-pin"></i> <%= move.end_point %></h5>
            <% end %>
            <br>
            <div class="link-container justify-content-between d-flex">
              <div><%= link_to "Details", move_path(move.id), class: "small_button" %></div>
              <% company = Company.find_by(user_id: current_user) %>
              <% if bid = move.bids.find_by(company_id: company) %>
                <div>
                  <h6>your bid</h6>
                  <div class="d-flex">
                    <h2><%= bid.price %> â‚¬</h2>
                    <%= link_to "", edit_move_bid_path(move.id, bid.id), class: "btn text-light fa-solid fa-pen" %>
                  </div>
                </div>
              <% else %>
                <%= link_to "Bid", new_move_bid_path(move.id), class: "small_button_goal" %>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
    <div class="right-container"
      data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"
      data-controller="map"
      data-map-markers-value="<%= @markers.to_json %>"
      id='map'
      style='width: 540px; height: 735px;'>
    </div>
  </div>

</div>
